package tweeter;

import java.sql.ResultSet;
import java.sql.SQLException;

import com.mysql.jdbc.Statement;

public class TwitterDatabaseController {
	
	private DatabaseConnection dc;
	
	private void initDatabaseConnectionControllers(){
		dc = new DatabaseConnection();	
	}
		
	private void runHamletTweets(){ //while schleife mit methode; Hauptmethode
		//get important things from databaseconnection
		System.out.println("get started");
		
		//get Person ID from Table "tweets"
		
	
		try {
			String query = "SELECT * FROM person";
			Statement st = dc.createStatement();
			ResultSet rs = st.executeQuery(query);
			
			while (rs.next())
		    {
		        int id = rs.getInt("id");
		        String name = rs.getString("name");
		        String key1 = rs.getString("key_1");
		        String key2 = rs.getString("key_2");
		        String key3 = rs.getString("key_3");
		        String key4 = rs.getString("key_4");
		         
		        // print the results
		        System.out.format("%s, %s, %s, %s, %s, %s\n", id, name, key1, key2, key3, key4);
		    }
		    st.close();
		      
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		 
		 
		System.out.println("end");
		
		
		//twitter4j.tweet(person, tweet_text,...)	
	}
	
	public void run(){
		initDatabaseConnectionControllers();
		runHamletTweets(); 
	}
	
	

}
